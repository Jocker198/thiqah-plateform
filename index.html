<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ù†ØµØ© Ø«Ù‚Ø© - Thiqah Platform</title>
<style>
/* ======= Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ Ø§Ù„Ù‚Ø¯ÙŠÙ… ======= */
:root {
  --primary-color: #0d6efd;
  --secondary-color: #084298;
  --bg-color: #f9fafb;
  --card-bg: #fff;
  --text-color: #333;
}
body { margin:0; font-family:'Cairo',sans-serif; background:var(--bg-color); color:var(--text-color); }
header { background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); padding:50px 20px; text-align:center; color:white; }
header h1 { font-size:42px; margin:0; }
header p { font-size:20px; opacity:.9; }
.container { max-width:1200px; margin:auto; padding:30px; }
.section { background:var(--card-bg); padding:40px; border-radius:20px; margin-top:30px; box-shadow:0 8px 25px rgba(0,0,0,0.1); }
button { background:var(--primary-color); color:white; border:none; padding:14px 22px; border-radius:12px; cursor:pointer; transition:.3s; font-size:16px; }
button:hover { background:var(--secondary-color); }
input, textarea { padding:14px; border-radius:10px; border:1px solid #ccc; font-size:16px; width:100%; margin-bottom:15px; }
textarea { height:100px; resize:none; }
.success-message { display:none; padding:15px; background:#d1f7d6; border:1px solid #9ee8a2; color:#1d6f2b; border-radius:10px; margin-top:12px; font-weight:bold; }
.card { margin-bottom:25px; padding:25px; border-radius:15px; background:#fff; box-shadow:0 4px 15px rgba(0,0,0,0.08); }
.review{border-bottom:1px solid #eee;padding:12px 0;opacity:0; transform:translateY(20px); transition: all 0.4s ease;}
.review.show{opacity:1; transform:translateY(0);}
.stars span{font-size:26px; cursor:pointer; transition: transform .2s;}
.stars span:hover{transform:scale(1.3);}
</style>
</head>
<body>
<header>
<h1>Ù…Ù†ØµØ© Ø«Ù‚Ø©</h1>
<p>Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø§Ù„Ø£ÙˆÙ„ Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ØªØ§Ø¬Ø± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© ÙÙŠ Ø§Ù„Ù…ØºØ±Ø¨</p>
</header>
<div class="container">

<!-- Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
<div id="home" class="section">
<h2>Ù„Ù…Ø§Ø°Ø§ Ù…Ù†ØµØ© Ø«Ù‚Ø©ØŸ</h2>
<p>Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø«Ù‚Ø© Ø¨ÙŠÙ† Ø§Ù„Ù…ØªØ§Ø¬Ø± ÙˆØ§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ù† Ø§Ù„Ø§Ø­ØªÙŠØ§Ù„.</p>
</div>

<!-- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…ØªØ¬Ø± -->
<div id="register" class="section">
<h2>Ø³Ø¬Ù‘Ù„ Ù…ØªØ¬Ø±Ùƒ</h2>
<form id="storeForm">
<input type="text" id="store_name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø±" required>
<input type="text" id="owner_name" placeholder="Ø§Ø³Ù… ØµØ§Ø­Ø¨ Ø§Ù„Ù…ØªØ¬Ø±" required>
<input type="tel" id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" required>
<input type="email" id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" required>
<input type="url" id="store_link" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ØªØ¬Ø± (Ø¥Ù† ÙˆØ¬Ø¯)">
<textarea id="description" placeholder="ÙˆØµÙ Ù…Ø®ØªØµØ± Ø¹Ù† Ø§Ù„Ù…ØªØ¬Ø±"></textarea>
<button type="submit">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
</form>
<div id="successBox" class="success-message">âœ” ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ù…ØªØ¬Ø±Ùƒ Ø¨Ù†Ø¬Ø§Ø­!</div>
</div>

<!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© -->
<div id="dashboard" class="section">
<h2>Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØªØ§Ø¬Ø±</h2>
<div id="requests"></div>
</div>

<!-- Ø¹Ø±Ø¶ Ø§Ù„Ù…ØªØ¬Ø± -->
<div id="shop-profile" class="section">
<h2 id="shopName">Ø§Ø®ØªØ± Ù…ØªØ¬Ø±Ù‹Ø§ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h2>
<div id="shopDesc"></div>
<div>Ø§Ù„Ù‡Ø§ØªÙ: <span id="shopPhone"></span></div>
<div>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: <span id="shopEmail"></span></div>
<div>Ø§Ù„Ø±Ø§Ø¨Ø·: <a id="shopLink" href="#" target="_blank"></a></div>
<div class="stars" id="stars">
<span data-v="1">â˜…</span><span data-v="2">â˜…</span><span data-v="3">â˜…</span><span data-v="4">â˜…</span><span data-v="5">â˜…</span>
</div>
<textarea id="reviewText" placeholder="Ø£Ø¶Ù ØªØ¹Ù„ÙŠÙ‚Ùƒ"></textarea>
<button onclick="addReview()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</button>
<h3>Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª</h3>
<div id="reviews"></div>
<br>
<input type="text" id="deleteToken" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ Ù„Ø­Ø°Ù Ù…ØªØ¬Ø±Ùƒ">
<button onclick="deleteMyShop()" style="background:red;">Ø­Ø°Ù Ù…ØªØ¬Ø±ÙŠ</button>
</div>

<!-- Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ù…ØªØ¬Ø± Ù…Ø­ØªØ§Ù„ -->
<div id="report" class="section">
<h2>Ø£Ø¨Ù„Øº Ø¹Ù† Ù…ØªØ¬Ø± Ù…Ø­ØªØ§Ù„</h2>
<input type="text" id="reportStoreName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù†Ù‡">
<textarea id="reportDesc" placeholder="ØµÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø£Ùˆ Ø§Ù„Ø§Ø­ØªÙŠØ§Ù„"></textarea>
<button onclick="reportShop()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ù„Ø§Øº</button>
<div id="reportSuccess" class="success-message">âœ” ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ù„Ø§Øº Ø¨Ù†Ø¬Ø§Ø­!</div>
</div>

<!-- Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠ -->
<div id="legal" class="section">
<h2>ØªÙ†Ø¨ÙŠÙ‡ Ù‚Ø§Ù†ÙˆÙ†ÙŠ</h2>
<p>Ù…Ù†ØµØ© Ø«Ù‚Ø© Ù‡ÙŠ ÙˆØ³ÙŠØ· Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙÙ‚Ø·ØŒ ÙˆÙ„Ø§ ØªØªØ­Ù…Ù„ Ø£ÙŠ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ø¹Ù† Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¨ÙŠØ¹ Ø£Ùˆ Ø§Ù„Ø´Ø±Ø§Ø¡ Ø¨ÙŠÙ† Ø§Ù„Ù…ØªØ§Ø¬Ø± ÙˆØ§Ù„Ø¹Ù…Ù„Ø§Ø¡.</p>
</div>

</div>
<script>
// ======= Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª =======
let shopsDB = []; // Ø­Ø°Ù Ø£ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©
let reportsDB = [];

// ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ
function generateToken(length = 8) {
  const chars = "ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789";
  let token = "";
  for (let i = 0; i < length; i++) {
    token += chars.charAt(Math.floor(Math.random() * chars.length));
  }
  return token;
}

// ØªØ³Ø¬ÙŠÙ„ Ù…ØªØ¬Ø±
const form = document.getElementById('storeForm');
const successBox = document.getElementById('successBox');
form.addEventListener('submit', function(e){
    e.preventDefault();
    const shopToken = generateToken();
    const shop = {
        id: shopsDB.length + 1,
        name: document.getElementById('store_name').value,
        owner: document.getElementById('owner_name').value,
        phone: document.getElementById('phone').value,
        email: document.getElementById('email').value,
        link: document.getElementById('store_link').value,
        desc: document.getElementById('description').value,
        token: shopToken
    };
    shopsDB.push(shop);
    form.reset();
    successBox.style.display='block';
    alert("âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ù…ØªØ¬Ø±Ùƒ Ø¨Ù†Ø¬Ø§Ø­\n\nğŸ” Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ:\n\n" + shopToken + "\n\nâš ï¸ Ø§Ø­ØªÙØ¸ Ø¨Ù‡ Ø¬ÙŠØ¯Ù‹Ø§.");
    renderDashboard();
});

// Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
const container = document.getElementById('requests');
function renderDashboard(){
    container.innerHTML='';
    shopsDB.forEach(shop=>{
        const div = document.createElement('div');
        div.className='card';
        div.innerHTML = `<strong>${shop.name}</strong> (<a href='#' onclick='loadShop(${shop.id})'>Ø¹Ø±Ø¶ Ø§Ù„Ù…ØªØ¬Ø±</a>)<br>ØµØ§Ø­Ø¨ Ø§Ù„Ù…ØªØ¬Ø±: ${shop.owner}<br>Ù‡Ø§ØªÙ: ${shop.phone}<br>Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: ${shop.email}<br>Ø±Ø§Ø¨Ø·: <a href='${shop.link}' target='_blank'>${shop.link}</a>`;
        container.appendChild(div);
    });
}
renderDashboard();

// Ø¹Ø±Ø¶ Ù…ØªØ¬Ø±
let selected = 0;
let reviews = [];
function loadShop(id){
    const shop = shopsDB.find(s=>s.id===id);
    if(!shop) return;
    document.getElementById('shopName').innerText = shop.name;
    document.getElementById('shopDesc').innerText = shop.desc;
    document.getElementById('shopPhone').innerText = shop.phone;
    document.getElementById('shopEmail').innerText = shop.email;
    document.getElementById('shopLink').innerText = shop.link;
    document.getElementById('shopLink').href = shop.link;
    reviews = JSON.parse(localStorage.getItem('reviews_' + id) || '[]');
    renderReviews();
}

// Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
document.querySelectorAll('#stars span').forEach(s=>{
  s.onclick = ()=>{
    selected = s.dataset.v;
    document.querySelectorAll('#stars span').forEach(x=>x.style.color = x.dataset.v <= selected ? 'gold' : '#000');
  };
});
function addReview(){
    let text = document.getElementById('reviewText').value.trim();
    if(!text || selected==0) return;
    let newReview = {stars:selected, text};
    reviews.push(newReview);
    const shopId = shopsDB.findIndex(s=>s.name===document.getElementById('shopName').innerText);
    localStorage.setItem('reviews_' + shopId, JSON.stringify(reviews));
    document.getElementById('reviewText').value="";
    selected=0;
    document.querySelectorAll('#stars span').forEach(x=>x.style.color='#000');
    renderReviews(newReview);
}
function renderReviews(latest=null){
  const box = document.getElementById('reviews');
  box.innerHTML='';
  reviews.forEach(r=>{
    let div=document.createElement('div');
    div.className='review';
    div.innerHTML = `<strong>${'â˜…'.repeat(r.stars)}</strong><br>${r.text}`;
    box.appendChild(div);
  });
  document.querySelectorAll('.review').forEach((el,i)=>{ setTimeout(()=>{el.classList.add('show');}, i*100); });
}

// Ø­Ø°Ù Ù…ØªØ¬Ø±
function deleteMyShop(){
    const tokenInput = document.getElementById('deleteToken').value.trim();
    const shopIndex = shopsDB.findIndex(s=>s.name===document.getElementById('shopName').innerText);
    if(shopIndex===-1){ alert('Ø§Ø®ØªØ± Ù…ØªØ¬Ø±Ù‹Ø§ Ø£ÙˆÙ„Ø§Ù‹'); return; }
    if(tokenInput===shopsDB[shopIndex].token){
        if(confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØ¬Ø±ØŸ')){
            shopsDB.splice(shopIndex,1);
            localStorage.setItem('shopsDB', JSON.stringify(shopsDB));
            localStorage.removeItem('reviews_' + shopIndex);
            alert('ØªÙ… Ø­Ø°Ù Ù…ØªØ¬Ø±Ùƒ Ø¨Ù†Ø¬Ø§Ø­!');
            location.reload();
        }
    } else {
        alert('Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­!');
    }
}

// Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ù…ØªØ¬Ø± Ù…Ø­ØªØ§Ù„
function reportShop(){
    const name = document.getElementById('reportStoreName').value.trim();
    const desc = document.getElementById('reportDesc').value.trim();
    if(!name || !desc) return;
    reportsDB.push({name, desc, date: new Date().toLocaleString()});
    localStorage.setItem('reportsDB', JSON.stringify(reportsDB));
    document.getElementById('reportStoreName').value='';
    document.getElementById('reportDesc').value='';
    document.getElementById('reportSuccess').style.display='block';
    setTimeout(()=>{document.getElementById('reportSuccess').style.display='none';},3000);
}

// Ø±Ø§Ø¨Ø· Google Sheets Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠ
const googleSheetsLink = ""; // Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø§Ø¨Ø· Ù„Ø§Ø­Ù‚Ù‹Ø§
</script>
</body>
</html>
